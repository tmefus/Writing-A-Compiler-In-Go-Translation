## 1. 编译器和虚拟机

对于大多数程序员来说，“编译器”这个词听起来可能有些令人望而生畏。即使你并不害怕它，你也无法否认编译器及其所做的事情被一种神秘和惊叹的氛围所包围。它们生成的机器代码似乎只有极少数人能够阅读或编写。它们执行着神奇的优化，不知怎的让代码运行得更快。它们的运行时间可能很长——几分钟甚至几十分钟。如果传言属实，有时它们甚至会运行数小时。如果需要这么长时间，那么它们所做的工作必定是非凡的。

说到传言：据说编译器非常庞大且极其复杂。实际上，它们经常被列入有史以来最复杂的软件项目之中——这些说法往往都有数据支持。这里举个例子： LLVM & Clang 项目目前大约由 300 万行代码组成。GNU 编译器集合（GCC）甚至更大，拥有 1500 万行代码。

并不是很多人看到这些数字后会打开他们的文本编辑器说：“你知道吗？让我们来构建一个！” 这些数字确实不会让人觉得可以在一个下午就写出一个编译器。

![这是图片](/pic/编译器和虚拟机1.png "执行流程")

虚拟机同样被广泛认为是神秘的存在，它们在软件开发的底层世界中游走，很少浮出水面，更少有人真正理解。关于虚拟机也有不少传言和猜测。有人说虚拟机与编译器有关，另一些人则坚持认为他们的编程语言实际上就是一种虚拟机。还有一部分人声称虚拟机允许他们在另一个操作系统内部运行一个操作系统。

而这些说法其实都有一定的道理。

编译器和虚拟机器在其核心是概念——模式，正如“解释器”或者“网络服务器”也是可以从小型到大型有多种实现的概念一样。在查看像GCC这样的项目后被它们吓倒，就如同看了 GitHub 之后就放弃建设网站一样没有道理。

诚然，为虚拟机创建一个编译器并非易事。但是它也并不像传闻中那样不可逾越。当我们对这些核心概念有了更深入的理解，了解了编译器和虚拟机到底是什么时，你会发现事实上你完全有可能在一个下午的时间里构建出一个编译器。

要达到这一点，第一步就是搞清楚“编译”究竟是什么意思。

<div style="width: 100%; border: 1px solid #000; padding: 10px; display: flex; justify-content: space-between; ">
  <a href="./4本书的使用.md" style="flex: 1; text-align: left; ">⬅ 本书的使用</a>
  <a href="./6编译器.md" style="flex: 1; text-align: right; ">编译器 ➡</a>
</div>
