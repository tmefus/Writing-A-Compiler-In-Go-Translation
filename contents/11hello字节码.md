## 2. Hello 字节码

我们的目标是在这一章中编译并执行这个Monkey表达式：

```JS
1 + 2
```

这听起来可能不是一个雄心勃勃的目标，但为了达成它，我们必须学习许多新知识，并建立大量的基础设施，这些将在接下来的章节中使用。通过选择简单的表达式1 + 2，我们不会被Monkey代码本身及其工作方式所分散注意力。我们可以专注于我们的编译器和虚拟机。

在本章结束时，我们希望能够做到：
* 接受 Monkey 表达式 `1 + 2`
* 使用现有的词法分析器、令牌(token)和解析器包对其进行词法分析和解析
* 获取结果抽象语法树（AST），其节点定义在我们的 ast 包中
* 将该 AST 传递给新构建的编译器，编译成字节码
* 取得字节码并将其交给同样新构建的虚拟机进行执行
* 确保虚拟机将结果转换为 `3`

表达式 `1 + 2` 将贯穿我们新解释器的所有主要部分：

![执行流程](/pic/字节码1.png)

就数据结构而言，你可以看到从开始到最终得到结果3，将会经历相当多的转换：

![数据转换](/pic/字节码2.png)

由于我们将大量使用在前一本书中构建的包，因此我们已经能够处理直到抽象语法树（AST）的所有内容。之后，我们将进入未知领域。我们需要定义字节码指令、构建一个编译器以及构造一个虚拟机——仅仅是为了将 `1 + 2` 转换成 `3` 。听起来很艰巨？别担心，我们将像往常一样，一步一步地从基础开始建设，并首先从字节码做起。

|[⬅ 字节码](./10字节码.md)|[第一个指令 ➡](./12第一个指令.md)|
| --- | --- |
